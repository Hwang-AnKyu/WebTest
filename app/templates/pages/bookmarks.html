{% extends 'base.html' %}

{% block title %}My Bookmarks - AICOM{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="flex items-center justify-between">
        <div class="space-y-1">
            <h1 class="text-2xl font-bold tracking-tight">My Bookmarks</h1>
            <p class="text-muted-foreground">{{ total }} bookmarked post(s)</p>
        </div>
        <a
            href="/profile"
            hx-get="/profile"
            hx-target="body"
            hx-push-url="true"
            class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none border border-input hover:bg-accent h-10 px-4"
        >
            Back to Profile
        </a>
    </div>

    <!-- Bookmarks List -->
    {% if bookmarks %}
    <div class="rounded-lg border">
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b bg-muted/50">
                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground w-full">Title</th>
                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground whitespace-nowrap">Author</th>
                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground whitespace-nowrap">Bookmarked</th>
                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground whitespace-nowrap">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for bookmark in bookmarks %}
                    <tr class="border-b transition-colors hover:bg-muted/50" id="bookmark-row-{{ bookmark.id }}">
                        <td class="p-4 align-middle">
                            <a
                                href="/posts/{{ bookmark.post.id }}"
                                hx-get="/posts/{{ bookmark.post.id }}"
                                hx-target="body"
                                hx-push-url="true"
                                class="font-medium hover:underline"
                            >
                                {{ bookmark.post.title }}
                            </a>
                        </td>
                        <td class="p-4 align-middle whitespace-nowrap text-muted-foreground">
                            {{ bookmark.post.author.username if bookmark.post.author else 'Unknown' }}
                        </td>
                        <td class="p-4 align-middle whitespace-nowrap text-muted-foreground">
                            {{ bookmark.created_at[:10] }}
                        </td>
                        <td class="p-4 align-middle whitespace-nowrap">
                            <form
                                action="/bookmarks/{{ bookmark.post.id }}/form"
                                method="POST"
                                hx-post="/bookmarks/{{ bookmark.post.id }}/form"
                                hx-target="#bookmark-row-{{ bookmark.id }}"
                                hx-swap="outerHTML"
                                class="inline"
                            >
                                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                <button
                                    type="submit"
                                    class="text-sm text-destructive hover:underline"
                                >
                                    Remove
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Pagination -->
    {% if total_pages > 1 %}
    <nav class="flex items-center justify-center space-x-2">
        {% if has_prev %}
        <a
            href="/profile/bookmarks?page={{ page - 1 }}"
            hx-get="/profile/bookmarks?page={{ page - 1 }}"
            hx-target="body"
            hx-push-url="true"
            class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none border border-input hover:bg-accent h-10 px-4"
        >
            Previous
        </a>
        {% endif %}

        {% for p in page_range %}
        <a
            href="/profile/bookmarks?page={{ p }}"
            hx-get="/profile/bookmarks?page={{ p }}"
            hx-target="body"
            hx-push-url="true"
            class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none h-10 w-10 {% if p == page %}bg-primary text-primary-foreground{% else %}border border-input hover:bg-accent{% endif %}"
        >
            {{ p }}
        </a>
        {% endfor %}

        {% if has_next %}
        <a
            href="/profile/bookmarks?page={{ page + 1 }}"
            hx-get="/profile/bookmarks?page={{ page + 1 }}"
            hx-target="body"
            hx-push-url="true"
            class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none border border-input hover:bg-accent h-10 px-4"
        >
            Next
        </a>
        {% endif %}
    </nav>
    {% endif %}

    {% else %}
    <div class="text-center py-12 text-muted-foreground border rounded-lg">
        <p>No bookmarks yet.</p>
        <p class="text-sm">Bookmark posts to find them easily later.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
